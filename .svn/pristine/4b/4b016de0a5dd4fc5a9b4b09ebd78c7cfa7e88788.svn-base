
<form id="form-popover" method="post">
    <!--  ==========  -->
    <!--  = Cart =  -->
    <!--  ==========  -->
    
        <div class="widget widget_shopping_cart " id="SummeryCart">

        </div>
    <!-- /cart -->
</form>
@System.Web.Optimization.Scripts.Render("~/Content/js/js.cookie.js");
<script type="text/javascript">

   
    var BasketCookie = 'JahanAraShopBasket';
    showCart();
    var cookie = [];
    cookie = Cookies.get(BasketCookie);
  
    function showCart() {
        if (cookie == undefined || cookie.length == 0) {
            $("#SummeryCart").html("سبد خرید خالی میباشد");
        }
        $.ajax({
            type: 'Post',
            url: '/Product/ShowCartItems/',
            dataType: "json",
            success: function (data) {
                if (!data.result) {
                    var item = "";
                    var totalprice = 0;
                    item += "<h5 class='title dirfloat '>سبد خرید شما </h5>"
                    item += "<ul class='scroll neo-mini-cart '>"
                    for (var i = 0; i < data.length; i++)
                    {


                        item += "<li class='item'>"
                        item += "<figure class='product-thumb'>"
                        item += "<a href='#'><img src='@(JahanAraShop.Application.Resources.Paths.ImageFolder)Products/defult.jpg' alt=''></a>"
                        item += "</figure>"
                        item += "<div class='item-disc'>"
                        item += "<h6 class='pri-font'>"+data[i].Name+"</h6>"
                        item += "<span class='qty'>" + data[i].Count + "</span>"+'X'+"<span class='item-price'>" + data[i].Price + "</span>"
                        item += "</div>"
                        item += "<a href='#' class='delete-item'><i class='pe-7s-close'></i></a>"
                        item += "</li>"

                        totalprice = totalprice + data[i].Price;

                    }

                    item += "</ul>"
                    item +="<div class='mini-cart-total flx-element'>"
                    item += "<span>جمع کل</span>"
                    item += "<span>" + ReplaceNumberWithCommas(totalprice) + " ریال</span>"
                    item +=  "</div>"
                    item +=  "<div class='btn-hold flx-element'>"
                    item +=   "<a class='btn text-uppercase' href='cart.html'>ادامه خرید</a>"
                    item += "<a class='btn pri-bg text-uppercase' href='checkout.html'>تکمیل خرید</a>"
                    item += " </div>"
                    $("#SummeryCart").html(item);
                    }

                    },
            error: function (jqXHR, textStatus, errorThrown) {
               // alert('error: ' + textStatus + ': ' + errorThrown);
            }
        });

    }
    function ReplaceNumberWithCommas(yourNumber) {
        var n = yourNumber.toString().split(".");
        n[0] = n[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return n.join(".");
    }
    $(function () {

        $('#hover-link').popover({
            html: true,
            trigger: 'manual',
            placement: 'bottom',
            content: $('#form-popover').html(),
            title: "title"
        }).on("mouseenter",

        function () {
            var _this = this;
            $(this).popover("show");
            $(this).siblings(".popover").on("mouseleave", function (e) {
                // e.fromElement and e.target.tagName hack to manage firing .popover "mouseleave" event when dropdown is open on Firefox and Chrome
                if ((typeof e.fromElement != 'undefined' && !e.fromElement.length) || (typeof e.fromElement == 'undefined' && e.target.tagName != 'SELECT' && e.target.tagName != 'OPTION' && e.target.tagName != 'FORM')) {
                    setTimeout(function () {
                        $(_this).popover('hide');
                    }, 100);
                }
            });

        }).on("mouseleave", function () {
            var _this = this;
            setTimeout(function () {
                if (!$(".popover:hover").length) {
                    $(_this).popover('hide');
                }
            }, 100);
        });
    });
    function Closepopup() {
        $('#hover-link').popover('hide');
    }

</script>