@model  JahanAraShop.Areas.Admin.Models.InvoiceReportModel
@using JahanAraShop.Services
@{
    ViewBag.Title = "InvoiceList";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<link href="~/Content/css/PersianDatePicker.min.css" rel="stylesheet" />
<section id="main-content">
    <section class="wrapper main-wrapper row" style=''>

        <div class='col-xs-12'>
            <div class="page-title">

                <div class="pull-right">
                    <!-- PAGE HEADING TAG - START --><h1 class="title">Invoices</h1><!-- PAGE HEADING TAG - END -->
                </div>

                <div class="pull-left hidden-xs">
                    <ol class="breadcrumb">
                        <li>
                            <a href="index.html"><i class="fa fa-home"></i>Home</a>
                        </li>
                        <li>
                            <a href="ui-invoice.html">Invoicing</a>
                        </li>
                        <li class="active">
                            <strong>Invoice Listing</strong>
                        </li>
                    </ol>
                </div>

            </div>
        </div>
        <div class="clearfix"></div>
        <!-- MAIN CONTENT AREA STARTS -->

        <div class="col-lg-12">
            <section class="box ">
                <header class="panel_header">
                    <h2 class="title pull-right">گزارش خرید</h2>
                    <div class="actions panel_actions pull-left">
                        <a class="box_toggle fa fa-chevron-down"></a>
                        <a class="box_setting fa fa-cog" data-toggle="modal" href="#section-settings"></a>
                        <a class="box_close fa fa-times"></a>
                    </div>
                </header>
                <div class="content-body dr">

                    <div class="row">
                        <div class="col-xs-6 fl">
                            @{string a = Utilities.FarsiDateTimeNow();}

                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary("", new { @class = "blockdisp text-danger" })

                            @Html.LabelFor(m => m.FromDate)
                            @Html.EditorFor(m => m.FromDate, new { htmlAttributes = new { id = "FromDate", @class = "form-control", placeholder = "----/--/--", maxlength = "10", onclick = "PersianDatePicker.Show(this,'" + a + "')" } })

                            @Html.LabelFor(m => m.ToDate)
                            @Html.EditorFor(m => m.ToDate, new { htmlAttributes = new { id = "ToDate", @class = "form-control", placeholder = "----/--/--", maxlength = "10", onclick = "PersianDatePicker.Show(this,'" + a + "')" } })
                            <br />


                            @Html.LabelFor(m => m.CustomerPhone)
                            @Html.TextBoxFor(m => m.CustomerPhone, new { @class = "form-control", id = "Customerphone" })

                            <br />
                            <div class="form-group">
                                <button onclick="GetReport()" class="btn btn-purple  pull-left">اعمال</button>
                            </div>
                            <br />
                        </div>
                        <table id="example" class="display table table-hover table-condensed"></table>
                    </div>

                </div>
            </section>
        </div>


        <!-- MAIN CONTENT AREA ENDS -->
    </section>
</section>



<script src="~/Areas/Admin/Contents/js/jquery.datatables.min.js" type="text/javascript"></script>
<script src="~/Areas/Admin/Contents/js/datatables.tabletools.min.js" type="text/javascript"></script>
<script src="~/Areas/Admin/Contents/js/datatables.responsive.min.js" type="text/javascript"></script>
<script src="~/Areas/Admin/Contents/js/datatables.bootstrap.js" type="text/javascript"></script>
@section Scripts {
    <script src="~/Content/js/PersianDatePicker.js"></script>
    <script type="text/javascript">


        function GetReport() {
            var fromdate = $("#FromDate").val();
            var todate = $("#ToDate").val();
            var phone = $("#Customerphone").val();

            var model = {
                FromDate: fromdate,
                ToDate: todate,
                CustomerPhone: phone,
            }

            $.ajax({
                type: 'Post',
                url: '/Panel/GetInvoiceReport/',
                data: { "model": model },
                dataType: "json",
                success: function (data) {
                    if (!data.result) {
                        var Row = 1;
                        var html = "";

                        html += "<thead style='text-align:center'><tr><th>ردیف</th><th>شماره رایانه ای</th><th>مشتری</th><th>تاریخ</th><th>مبلغ</th><th> وضعیت</th></tr></thead>"
                        html += "<tbody>"
                        for (var i = 0; i < data.length; i++) {


                            html += " <tr style='text-align:center'>"
                            html += "<td>" + Row + "</td>"
                            html += "<td>" + data[i].Id + "</td>"
                            html += "<td>" + data[i].organame + "</td>"
                            html += "<td>" + data[i].FarsiCreateDate + "</td>"
                            html += "<td>" + data[i].TotalValue + "</td>"
                            if (data[i].Transfer == true) {

                                html += " <td><span style='color:green;'><i class='fa fa-check'></i></span></td>"
                            }
                            else {
                                html += " <td><span style='color:red;'><i class='fa fa-times'></i></span></td>"

                            }
                            html += " <tr>"
                            Row++;


                        }
                        html += " </tbody>"

                        $("#example").html(html);
                    }



                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('error: ' + textStatus + ': ' + errorThrown);
                }
            });
        }
    </script>
}
